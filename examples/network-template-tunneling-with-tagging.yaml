adv_net_template:
  default:
    network_assignments:
      fuelweb_admin:
        ep: br-fw-admin
      management:
        ep: br-mgmt
      private:
        ep: br-mesh
      public:
        ep: br-ex
      storage:
        ep: br-storage
    network_scheme:
      admin:
        endpoints:
        - br-fw-admin
        roles:
          admin/pxe: br-fw-admin
          fw-admin: br-fw-admin
        transformations:
        - action: add-br
          name: br-fw-admin
        - action: add-port
          bridge: br-fw-admin
          name: <% if1 %>
      mgmt-cpu:
        endpoints:
        - br-mgmt
        roles:
          neutron/private: br-mgmt
          ceilometer/api: br-mgmt
          ceph/public: br-mgmt
          glance/api: br-mgmt
          heat/api: br-mgmt
          horizon: br-mgmt
          keystone/api: br-mgmt
          management: br-mgmt
          mgmt/api: br-mgmt
          mgmt/corosync: br-mgmt
          mgmt/database: br-mgmt
          mgmt/memcache: br-mgmt
          mgmt/messaging: br-mgmt
          mgmt/vip: br-mgmt
          mongo/db: br-mgmt
          murano/api: br-mgmt
          neutron/api: br-mgmt
          nova/api: br-mgmt
          nova/migration: br-mgmt
          sahara/api: br-mgmt
          swift/api: br-mgmt
        transformations:
        - action: add-br
          name: br-mgmt
        - action: add-port
          bridge: br-mgmt
          name: <% if2 %>.100
      mgmt-ctrl:
        endpoints:
        - br-mgmt
        roles:
          neutron/private: br-mgmt
          ceilometer/api: br-mgmt
          ceph/public: br-mgmt
          glance/api: br-mgmt
          heat/api: br-mgmt
          horizon: br-mgmt
          keystone/api: br-mgmt
          management: br-mgmt
          mgmt/api: br-mgmt
          mgmt/corosync: br-mgmt
          mgmt/database: br-mgmt
          mgmt/memcache: br-mgmt
          mgmt/messaging: br-mgmt
          mgmt/vip: br-mgmt
          mongo/db: br-mgmt
          murano/api: br-mgmt
          neutron/api: br-mgmt
          nova/api: br-mgmt
          nova/migration: br-mgmt
          sahara/api: br-mgmt
          swift/api: br-mgmt
        transformations:
        - action: add-br
          name: br-mgmt
        - action: add-port
          bridge: br-mgmt
          name: <% if4 %>
      public-private-cpu:
        endpoints:
        - br-mesh
        - br-ex
        roles:
          ceph/radosgw: br-ex
          cinder/api: br-ex
          public/vip: br-ex
          ex: br-ex
          neutron/mesh: br-mesh
          neutron/floating: br-floating
        transformations:
        - action: add-br
          name: br-ex
        - action: add-br
          name: br-mesh
        - action: add-br
          name: br-floating
          provider: ovs
        - action: add-patch
          bridges:
          - br-floating
          - br-ex
          provider: ovs
          mtu: 65000
        - action: add-bond
          interfaces:
          - <% if3 %>
          - <% if4 %>
          bond_properties:
            lacp_rate: fast
            mode: 802.3ad
            xmit_hash_policy: layer3+4
          name: bond0
          interface_properties:
            vendor_specific:
              disable_offloading: true
        - action: add-port
          bridge: br-ex
          name: bond0.200
        - action: add-port
          bridge: br-mesh
          name: bond0.400
      public-private-ctrl:
        endpoints:
        - br-mesh
        - br-ex
        roles:
          ceph/radosgw: br-ex
          cinder/api: br-ex
          public/vip: br-ex
          ex: br-ex
          neutron/mesh: br-mesh
          neutron/floating: br-floating
        transformations:
        - action: add-br
          name: br-mesh
        - action: add-br
          name: br-ex
        - action: add-br
          name: br-floating
          provider: ovs
        - action: add-patch
          bridges:
          - br-floating
          - br-ex
          provider: ovs
          mtu: 65000
        - action: add-port
          bridge: br-mesh
          name: <% if5 %>
        - action: add-port
          bridge: br-ex
          name: <% if2 %>
      storage-cpu:
        endpoints:
        - br-storage
        roles:
          ceph/replication: br-storage
          cinder/iscsi: br-storage
          storage: br-storage
          swift/replication: br-storage
        transformations:
        - action: add-br
          name: br-storage
        - action: add-bond
          interfaces:
          - <% if5 %>
          - <% if6 %>
          bond_properties:
            mode: balance-rr
          name: bond1
          interface_properties:
            vendor_specific:
              disable_offloading: true
        - action: add-port
          bridge: br-storage
          name: bond1.300
      storage-ctrl:
        endpoints:
        - br-storage
        roles:
          ceph/replication: br-storage
          cinder/iscsi: br-storage
          storage: br-storage
          swift/replication: br-storage
        transformations:
        - action: add-br
          name: br-storage
        - action: add-port
          bridge: br-storage
          name: <% if3 %>
    nic_mapping:
      default:
        if1: eth0
        if2: eth1
        if3: eth2
        if4: eth3
        if5: eth4
        if6: eth5
    templates_for_node_role:
      compute:
      - admin
      - mgmt-cpu
      - public-private-cpu
      - storage-cpu
      controller:
      - admin
      - mgmt-ctrl
      - public-private-ctrl
      - storage-ctrl
      virt:
      - admin
      - mgmt-cpu
      - public-private-cpu
      - storage-cpu
